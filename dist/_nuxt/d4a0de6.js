(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{458:function(t,e,n){"use strict";var o=n(3),c=n(57),r=n(463),l=n(271),d=n(7),f=1..toFixed,h=Math.floor,v=function(t,e,n){return 0===e?n:e%2==1?v(t,e-1,n*t):v(t*t,e/2,n)};o({target:"Number",proto:!0,forced:f&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!d((function(){f.call({})}))},{toFixed:function(t){var e,n,o,d,f=r(this),m=c(t),data=[0,0,0,0,0,0],x="",C="0",w=function(t,e){for(var n=-1,o=e;++n<6;)o+=t*data[n],data[n]=o%1e7,o=h(o/1e7)},_=function(t){for(var e=6,n=0;--e>=0;)n+=data[e],data[e]=h(n/t),n=n%t*1e7},y=function(){for(var t=6,s="";--t>=0;)if(""!==s||0===t||0!==data[t]){var e=String(data[t]);s=""===s?e:s+l.call("0",7-e.length)+e}return s};if(m<0||m>20)throw RangeError("Incorrect fraction digits");if(f!=f)return"NaN";if(f<=-1e21||f>=1e21)return String(f);if(f<0&&(x="-",f=-f),f>1e-21)if(n=(e=function(t){for(var e=0,n=t;n>=4096;)e+=12,n/=4096;for(;n>=2;)e+=1,n/=2;return e}(f*v(2,69,1))-69)<0?f*v(2,-e,1):f/v(2,e,1),n*=4503599627370496,(e=52-e)>0){for(w(0,n),o=m;o>=7;)w(1e7,0),o-=7;for(w(v(10,o,1),0),o=e-1;o>=23;)_(1<<23),o-=23;_(1<<o),w(1,1),_(2),C=y()}else w(0,n),w(1<<-e,0),C=y()+l.call("0",m);return C=m>0?x+((d=C.length)<=m?"0."+l.call("0",m-d)+C:C.slice(0,d-m)+"."+C.slice(d-m)):x+C}})},463:function(t,e,n){var o=n(46);t.exports=function(t){if("number"!=typeof t&&"Number"!=o(t))throw TypeError("Incorrect invocation");return+t}},464:function(t,e,n){"use strict";n.r(e);n(37),n(26),n(458),n(39),n(36);var o={name:"rtnumberchart",props:["config"],data:function(){return{receivedTime:0,value:0,time:Date.now(),nowTime:Date.now(),isMounted:!1,topic:"",chartOptions:{credits:{enabled:!1},chart:{renderTo:"container",defaultSeriesType:"line",type:"",backgroundColor:"rgba(0,0,0,0)"},title:{text:""},xAxis:{type:"datetime",labels:{style:{color:"#d4d2d2"}}},yAxis:{title:{text:""},labels:{style:{color:"#d4d2d2",font:"11px Trebuchet MS, Verdana, sans-serif"}}},plotOptions:{series:{label:{connectorAllowed:!1},pointStart:2010},areaspline:{fillOpacity:.05}},series:[{name:"",data:[],color:"#e14eca"}],legend:{itemStyle:{color:"#d4d2d2"}},responsive:{rules:[{condition:{maxWidth:500},chartOptions:{legend:{layout:"horizontal",align:"center",verticalAlign:"bottom"}}}]}}}},watch:{config:{immediate:!0,deep:!0,handler:function(){var t=this;setTimeout((function(){t.value=0,t.$nuxt.$off(t.topic+"/sdata"),t.topic=t.config.userId+"/"+t.config.selectedDevice.dId+"/"+t.config.variable,t.$nuxt.$on(t.topic+"/sdata",t.procesReceivedData),t.chartOptions.series[0].data=[],t.getChartData(),t.chartOptions.series[0].name=t.config.variableFullName+" "+t.config.unit,t.updateColorClass(),t.getChartType(),window.dispatchEvent(new Event("resize"))}),300)}}},mounted:function(){this.getNow(),this.updateColorClass(),this.getChartType()},beforeDestroy:function(){this.$nuxt.$off(this.topic+"/sdata")},methods:{updateColorClass:function(){console.log("update"+this.config.class);var t=this.config.class;"success"==t&&(this.chartOptions.series[0].color="#00f2c3"),"primary"==t&&(this.chartOptions.series[0].color="#e14eca"),"warning"==t&&(this.chartOptions.series[0].color="#ff8d72"),"danger"==t&&(this.chartOptions.series[0].color="#fd5d93"),this.chartOptions.series[0].name=this.config.variableFullName+" "+this.config.unit},getChartData:function(){var t=this;if(this.config.demo)return this.chartOptions.series[0].data=[[1606659071668,22],[1606659072668,27],[1606659073668,32],[1606659074668,7]],void(this.isMounted=!0);var e={headers:{token:$nuxt.$store.state.auth.token},params:{dId:this.config.selectedDevice.dId,variable:this.config.variable,chartTimeAgo:this.config.chartTimeAgo}};this.$axios.get("/get-small-charts-data",e).then((function(e){t.chartOptions.series[0].data=[];var data=e.data.data;console.log(e.data),data.forEach((function(element){var e=[];e.push(element.time+60*(new Date).getTimezoneOffset()*1e3*-1),e.push(element.value),t.chartOptions.series[0].data.push(e)})),t.isMounted=!0})).catch((function(t){console.log(t)}))},getIconColorClass:function(){return"success"==this.config.class?"text-success":"primary"==this.config.class?"text-primary":"warning"==this.config.class?"text-warning":"danger"==this.config.class?"text-danger":void 0},procesReceivedData:function(data){var t=this;try{this.time=Date.now(),this.value=data.value,setTimeout((function(){1==data.save&&t.getChartData()}),1e3)}catch(t){console.log(t)}},getNow:function(){var t=this;this.nowTime=Date.now(),setTimeout((function(){t.getNow()}),1e3)},getTimeAgo:function(t){return t<0&&(t=0),t<59?t.toFixed()+" secs":t>59&&t<=3600?(t/=60).toFixed()+" min":t>3600&&t<=86400?(t/=3600).toFixed()+" hour":t>86400?(t/=86400).toFixed()+" day":void 0},getChartType:function(){var t=this.config.typeChart;"line"==t&&(this.chartOptions.chart.type="line"),"spline"==t&&(this.chartOptions.chart.type="spline"),"area"==t&&(this.chartOptions.chart.type="area"),"areaspline"==t&&(this.chartOptions.chart.type="areaspline")}}},c=n(1),component=Object(c.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("card",{attrs:{type:"chart"}},[n("template",{slot:"header"},[n("h5",{staticClass:"card-category pull-right"},[t._v(t._s(t.getTimeAgo((t.nowTime-t.time)/1e3))+" ago ")]),t._v(" "),n("h5",{staticClass:"card-category"},[t._v(t._s(t.config.selectedDevice.name)+" - "+t._s(t.config.variableFullName))]),t._v(" "),n("h3",{staticClass:"card-title"},[n("i",{staticClass:"fa ",class:[t.config.icon,t.getIconColorClass()],staticStyle:{"font-size":"30px"},attrs:{"aria-hidden":"true"}}),t._v(" "),n("span",[t._v(t._s(t.value.toFixed(t.config.decimalPlaces))+" "+t._s(t.config.unit))])])]),t._v(" "),n("div",{staticClass:"chart-area",staticStyle:{height:"300px"}},[t.isMounted?n("highchart",{staticStyle:{height:"100%"},attrs:{options:t.chartOptions}}):t._e()],1)],2)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{Card:n(71).default})},465:function(t,e,n){"use strict";n.r(e);var o={name:"iotswitch",props:["config"],data:function(){return{value:!0}},watch:{config:{immediate:!0,deep:!0,handler:function(){}}},mounted:function(){},beforeDestroy:function(){},methods:{getIconColorClass:function(){return this.value?"success"==this.config.class?"text-success":"primary"==this.config.class?"text-primary":"warning"==this.config.class?"text-warning":"danger"==this.config.class?"text-danger":void 0:"text-dark"},sendValue:function(){var t={topic:this.config.userId+"/"+this.config.selectedDevice.dId+"/"+this.config.variable+"/actdata",msg:{value:this.value}};$nuxt.$emit("mqtt-sender",t)}}},c=n(1),component=Object(c.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("card",[n("template",{slot:"header"},[n("h5",{staticClass:"card-category"},[t._v(" "+t._s(t.config.selectedDevice.name)+" - "+t._s(t.config.variableFullName))]),t._v(" "),n("h3",{staticClass:"card-title"},[n("i",{staticClass:"fa ",class:[t.config.icon,t.getIconColorClass()],staticStyle:{"font-size":"30px"},attrs:{"aria-hidden":"true"}}),t._v(" "),n("base-switch",{staticClass:"pull-right",staticStyle:{"margin-top":"10px"},attrs:{value:t.value,type:"primary","on-text":"ON","off-text":"OFF"},on:{click:function(e){t.value=!t.value,t.sendValue()}}})],1)])],2)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{BaseSwitch:n(116).default,Card:n(71).default})},466:function(t,e,n){"use strict";n.r(e);n(36);var o={props:["config"],data:function(){return{sending:!1}},mounted:function(){},methods:{sendValue:function(){var t=this;this.sending=!0,setTimeout((function(){t.sending=!1}),500);var e={topic:this.config.userId+"/"+this.config.selectedDevice.dId+"/"+this.config.variable+"/actdata",msg:{value:this.config.message}};console.log(e),this.$nuxt.$emit("mqtt-sender",e)},getIconColorClass:function(){return"success"==this.config.class?"text-success":"primary"==this.config.class?"text-primary":"warning"==this.config.class?"text-warning":"danger"==this.config.class?"text-danger":void 0}}},c=n(1),component=Object(c.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("card",[n("div",{attrs:{slot:"header"},slot:"header"},[n("h4",{staticClass:"card-title"},[t._v("\n      "+t._s(t.config.selectedDevice.name)+" - "+t._s(t.config.variableFullName)+"\n    ")])]),t._v(" "),n("i",{staticClass:"fa ",class:[t.config.icon,t.getIconColorClass()],staticStyle:{"font-size":"50px"}}),t._v(" "),n("base-button",{staticClass:"mb-3 pull-right",attrs:{type:t.config.class,size:"lg"},on:{click:function(e){return t.sendValue()}}},[t._v(t._s(t.config.text))])],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{BaseButton:n(72).default,Card:n(71).default})},467:function(t,e,n){"use strict";n.r(e);n(36);var o={props:["config"],data:function(){return{value:!1,topic:"",props:["config"]}},watch:{config:{immediate:!0,deep:!0,handler:function(){var t=this;setTimeout((function(){t.value=!1,t.$nuxt.$off(t.topic);var e=t.config.userId+"/"+t.config.selectedDevice.dId+"/"+t.config.variable+"/sdata";t.$nuxt.$on(e,t.processReceivedData)}),300)}}},mounted:function(){var t=this.config.userId+"/"+this.config.selectedDevice.dId+"/"+this.config.variable+"/sdata";this.$nuxt.$on(t,this.processReceivedData)},beforeDestroy:function(){this.$nuxt.$off(this.topic)},methods:{processReceivedData:function(data){try{console.log("received"),console.log(data),this.value=data.value}catch(t){console.log(t)}},getIconColorClass:function(){return this.value?"success"==this.config.class?"text-success":"primary"==this.config.class?"text-primary":"warning"==this.config.class?"text-warning":"danger"==this.config.class?"text-danger":void 0:"text-dark"}}},c=n(1),component=Object(c.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("card",[n("div",{attrs:{slot:"header"},slot:"header"},[n("h4",{staticClass:"card-title"},[t._v("\n      "+t._s(t.config.selectedDevice.name)+" - "+t._s(t.config.variableFullName)+"\n    ")])]),t._v(" "),n("i",{staticClass:"fa ",class:[t.config.icon,t.getIconColorClass()],staticStyle:{"font-size":"30px"}})])}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{Card:n(71).default})},468:function(t,e,n){"use strict";n.r(e);n(117),n(458),n(11),n(38),n(90),n(36),n(272);var o={name:"espCam",props:["config"],data:function(){return{receivedTime:0,value:0,time:Date.now(),nowTime:Date.now(),isMounted:!1,topic:"",img:"",wsHost:"192.168.1.37",wsPort:"8888"}},mounted:function(){var t=this;this.getNow();var e="ws:///".concat(this.wsHost,":").concat(this.wsPort),n=new WebSocket(e);n.onopen=function(){return console.log("Connected to ".concat(e))},n.onmessage=function(e){var n=e.data;t.img=URL.createObjectURL(new Blob([n]))}},methods:{getNow:function(){var t=this;this.nowTime=Date.now(),setTimeout((function(){t.getNow()}),1e3)},getTimeAgo:function(t){return t<0&&(t=0),t<59?t.toFixed()+" secs":t>59&&t<=3600?(t/=60).toFixed()+" min":t>3600&&t<=86400?(t/=3600).toFixed()+" hour":t>86400?(t/=86400).toFixed()+" day":void 0},getIconColorClass:function(){return"success"==this.config.class?"text-success":"primary"==this.config.class?"text-primary":"warning"==this.config.class?"text-warning":"danger"==this.config.class?"text-danger":void 0}}},c=n(1),component=Object(c.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("card",{attrs:{type:"chart"}},[n("template",{slot:"header"},[n("h5",{staticClass:"card-category pull-right"},[t._v(t._s(t.getTimeAgo((t.nowTime-t.time)/1e3))+" ago ")]),t._v(" "),n("h5",{staticClass:"card-category"},[t._v(t._s(t.config.selectedDevice.name)+" - "+t._s(t.config.variableFullName))]),t._v(" "),n("h3",{staticClass:"card-title"},[n("i",{staticClass:"fa ",class:[t.config.icon,t.getIconColorClass()],staticStyle:{"font-size":"30px"},attrs:{"aria-hidden":"true"}})])]),t._v(" "),n("div",{staticClass:"img-area"},[n("img",{attrs:{src:t.img,height:"100%",width:"450px"}})])],2)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{Card:n(71).default})},492:function(t,e,n){"use strict";n.r(e);n(26);var o={middleware:"authenticated",name:"Dashboard",data:function(){return{}},mounted:function(){},methods:{fixWidget:function(t){var e=JSON.parse(JSON.stringify(t));return e.selectedDevice.dId=this.$store.state.selectedDevice.dId,e.selectedDevice.name=this.$store.state.selectedDevice.name,e.userId=this.$store.state.selectedDevice.userId,"numberchart"==t.widget&&(e.demo=!1),e}}},c=n(1),component=Object(c.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.$store.state.devices.length>0?n("div",{staticClass:"row"},t._l(t.$store.state.selectedDevice.template.widgets,(function(e,o){return n("div",{key:o,class:[e.column]},["numberchart"==e.widget?n("Rtnumberchart",{attrs:{config:t.fixWidget(e)}}):t._e(),t._v(" "),"switch"==e.widget?n("Iotswitch",{attrs:{config:t.fixWidget(e)}}):t._e(),t._v(" "),"button"==e.widget?n("Iotbutton",{attrs:{config:t.fixWidget(e)}}):t._e(),t._v(" "),"indicator"==e.widget?n("Iotindicator",{attrs:{config:t.fixWidget(e)}}):t._e(),t._v(" "),"espCam"==e.widget?n("EspCam",{attrs:{config:t.fixWidget(e)}}):t._e()],1)})),0):n("div",[t._v("\n  Select a Device...\n")])}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{Rtnumberchart:n(464).default,Iotswitch:n(465).default,Iotbutton:n(466).default,Iotindicator:n(467).default,EspCam:n(468).default})}}]);